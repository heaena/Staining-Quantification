(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21697b"],{c2b8:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=this,t=a.$createElement,r=a._self._c||t;return r("a-card",{attrs:{bordered:!1}},[r("div",[r("a-row",{attrs:{gutter:0}},[r("a-col",{attrs:{md:10,sm:24}},[r("a-form",{attrs:{layout:"inline"}},[r("a-form-item",[r("a-button",{attrs:{icon:"arrow-up",type:"primary"},on:{click:function(e){return a.showUploadModal()}}},[a._v("Upload Image")]),r("a-button",{directives:[{name:"show",rawName:"v-show",value:a.createFolderShow,expression:"createFolderShow"}],attrs:{icon:"folder-add"},on:{click:function(e){return a.clickAddFolder()}}},[a._v("Create New Folder")])],1)],1)],1),r("a-col",{attrs:{md:14,sm:24}},[r("a-form",{attrs:{layout:"inline"}},[r("a-form-item",{attrs:{label:"File Name"}},[r("a-input",{attrs:{placeholder:"File Name"},model:{value:a.queryParam.name,callback:function(e){a.$set(a.queryParam,"name",e)},expression:"queryParam.name"}})],1),r("a-form-item",[r("a-button",{on:{click:function(e){return a.loadData()}}},[a._v("Search")]),r("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){return e.queryParam={}}}},[a._v("Reset")])],1)],1)],1)],1)],1),r("a-breadcrumb",{attrs:{separator:"/"}},a._l(a.breadcrumb,(function(e,t){return r("a-breadcrumb-item",{key:e.id},[t!==a.breadcrumb.length-1?r("a",{on:{click:function(t){return a.onClickBreadcrumb(e)}}},[a._v(a._s(e.name))]):r("span",[a._v(a._s(e.name))])])})),1),r("a-table",{attrs:{"data-source":a.dataSource,rowKey:"path"}},[r("a-table-column",{key:"name",attrs:{title:"File Name","data-index":"name"},scopedSlots:a._u([{key:"default",fn:function(e,t){return[r("a",{on:{click:function(e){return a.onClickItem(t)}}},[!0===t.dir?r("a-icon",{staticStyle:{color:"goldenrod",fontSize:"20px","margin-right":"10px"},attrs:{type:"folder",theme:"filled"}}):r("a-icon",{staticStyle:{fontSize:"20px","margin-right":"10px"},attrs:{type:"file-text",theme:"filled"}}),r("span",{staticStyle:{color:"black"}},[a._v(a._s(t.name))])],1)]}}])}),r("a-table-column",{key:"lastModified",attrs:{title:"Last Edited Time","data-index":"lastModified"},scopedSlots:a._u([{key:"default",fn:function(e,t){return[a._v(" "+a._s(a.formatDate(t.lastModified))+" ")]}}])}),r("a-table-column",{key:"action",attrs:{title:"Action"},scopedSlots:a._u([{key:"default",fn:function(e,t){return[r("span",[r("a-button",{on:{click:function(e){return a.deleteFile(t)}}},[a._v("Delete")]),r("a-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:function(e){return a.onClickAnalysis(t)}}},[a._v("Create Analysis Task")])],1)]}}])})],1),r("a-drawer",{attrs:{title:a.image.name,placement:"left",closable:!0,maskClosable:!1,visible:a.image.showModal,width:"90%"},on:{close:a.handleImageModalCancel}},[r("a",{staticStyle:{"font-size":"20px",border:"silver 1px"},attrs:{href:a.image.resourcePath,download:a.image.name}},[a._v("Download")]),r("span",{staticStyle:{"margin-left":"20px"}},[a._v("Image path： "+a._s(a.image.canonicalFilePath))]),r("img",{attrs:{src:a.image.resourcePath,width:"100%"}})]),r("a-modal",{attrs:{title:"Create New Folder",visible:a.folder.showModal,okText:"OK",cancelText:"Cancel"},on:{cancel:a.handleFolderModalCancel,ok:a.handleFolderModalOk}},[r("a-input",{attrs:{placeholder:"Folder Name"},model:{value:a.folder.name,callback:function(e){a.$set(a.folder,"name",e)},expression:"folder.name"}})],1),r("a-modal",{attrs:{title:"Upload Image",visible:a.upload.showModal,okText:"OK",cancelText:"Cancel"},on:{cancel:a.handleUploadModalCancel,ok:a.handleUploadModalOk}},[r("a-upload",{attrs:{name:"files",accept:"image/*",multiple:!0,withCredentials:!0,listType:"picture",action:"/api/sourceImage/uploadFile",headers:a.headers,data:a.getUploadData(),showUploadList:a.upload.showUploadList},on:{change:a.handleChange},model:{value:a.upload.fileList,callback:function(e){a.$set(a.upload,"fileList",e)},expression:"upload.fileList"}},[r("a-button",{attrs:{type:"primary"}},[r("a-icon",{attrs:{type:"upload"}}),a._v(" Choose Image ")],1)],1)],1),r("a-modal",{attrs:{title:"Create Analysis Task",visible:a.analysisModal.showModal,okText:"OK",cancelText:"Cancel"},on:{cancel:a.onClickAnalysisModalCancel,ok:a.onClickAnalysisModalOk}},[r("a-form",{attrs:{form:a.analysisForm,"label-col":{span:7},"wrapper-col":{span:16}}},[r("a-form-item",{attrs:{label:"Task Title"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["taskName",{rules:[{required:!0,message:"Please input!"}]}],expression:"['taskName', { rules: [{ required: true, message: 'Please input!' }] }]"}],attrs:{placeholder:"Mark this task",maxLength:50}})],1),r("a-form-item",{attrs:{label:"local density filter",extra:"note: denosing parameter. default value is 0. The most commonly used range of this parameter is 0~0.05."}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["d-thr",{initialValue:"0.01"},{rules:[{required:!0,message:"Please select!"}]}],expression:"['d-thr', {initialValue: '0.01'}, { rules: [{ required: true, message: 'Please select!' }] }]"}],staticStyle:{width:"100%"},attrs:{min:0,placeholder:"denosing parameter"}})],1),r("a-form-item",{attrs:{label:"fill",extra:"note: dilate parameter. default value is 10. The most commonly used range is 0~15"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["fill",{initialValue:"10"},{rules:[{required:!0,message:"Please select!"}]}],expression:"['fill', {initialValue: '10'}, { rules: [{ required: true, message: 'Please select!' }] }]"}],staticStyle:{width:"100%"},attrs:{min:0,placeholder:"dilate parameter"}})],1),r("a-form-item",{attrs:{label:"flood",extra:"note: default value is Yes. whether to flood the connected areas"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["flood",{initialValue:"Y"},{rules:[{required:!0,message:"Please select!"}]}],expression:"[\n            'flood', {initialValue: 'Y'},\n            { rules: [{ required: true, message: 'Please select!' }] },\n          ]"}],attrs:{placeholder:"whether to flood the connected areas"}},[r("a-select-option",{attrs:{value:"Y"}},[a._v(" Yes ")]),r("a-select-option",{attrs:{value:"N"}},[a._v(" No ")])],1)],1),r("a-form-item",{attrs:{label:"object area excluded",extra:"note: denosing parameter. default value is 5%. The most commonly used range is 0~10%."}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["obj-thr",{initialValue:"5"},{rules:[{required:!0,message:"Please select!"}]}],expression:"['obj-thr', {initialValue: '5'}, { rules: [{ required: true, message: 'Please select!' }] }]"}],staticStyle:{width:"100%"},attrs:{min:0,max:100,placeholder:"denosing parameter",formatter:function(e){return e+"%"},parser:function(e){return e.replace("%","")}}})],1),r("a-form-item",{attrs:{label:"staining threshold",extra:"note: the staining threshold paramter ranges from 0~255. the default for Von Kossa staining is set to 140, and for Alizarin Red is set to 100."}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["stained-thr",{initialValue:"100"},{rules:[{required:!0,message:"Please select!"}]}],expression:"['stained-thr', {initialValue: '100'}, { rules: [{ required: true, message: 'Please select!' }] }]"}],staticStyle:{width:"100%"},attrs:{min:0,max:255,placeholder:"the staining threshold paramter"}})],1)],1)],1)],1)},l=[],o=(t("a434"),t("b0c0"),t("cd17"),t("ed3b")),s=(t("3b18"),t("f64c")),i=t("b775"),n={sourceList:"/sourceImage/list",addFolder:"/sourceImage/addFolder",removeFile:"/sourceImage/remove",createTask:"/sourceImage/createTask"};function d(e){return Object(i["b"])({url:n.createTask,method:"post",data:e})}function c(e){return Object(i["b"])({url:n.sourceList,method:"get",params:e})}function u(e){return Object(i["b"])({url:n.addFolder,method:"post",params:e})}function m(e){return Object(i["b"])({url:n.removeFile,method:"delete",params:e})}var h=t("c1df"),f=t.n(h),p={name:"TableList",data:function(){return{analysisForm:{},headers:{authorization:"authorization-text"},image:{name:"",showModal:!1,scr:""},folder:{name:"",showModal:!1},upload:{showModal:!1,showUploadList:{showRemoveIcon:!1},fileList:[]},breadcrumb:[{name:"All Files",path:""}],visible:!1,confirmLoading:!1,queryParam:{parentPath:"",name:""},dataSource:[],analysisModal:{showModal:!1,param:{path:""}},createFolderShow:!0}},filters:{},created:function(){this.loadData()},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{formatDate:function(e){return f()(e).format("YYYY-MM-DD HH:mm:ss")},showUploadModal:function(){this.upload.fileList=[],this.upload.showModal=!0},handleUploadModalOk:function(){this.loadData(),this.upload.showModal=!1},handleUploadModalCancel:function(){this.loadData(),this.upload.showModal=!1},getUploadData:function(){return{parentPath:this.queryParam.parentPath}},handleChange:function(e){e.file.status,"done"===e.file.status?s["a"].success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&s["a"].error("".concat(e.file.name," file upload failed."))},handleFolderModalCancel:function(){this.folder.showModal=!1},handleFolderModalOk:function(){var e=this,a={name:this.folder.name,parentPath:this.queryParam.parentPath};u(a).then((function(a){e.loadData(),e.folder.showModal=!1}))},clickAddFolder:function(){this.folder.name="",this.folder.showModal=!0},onClickBreadcrumb:function(e){this.queryParam.parentPath=e.path;for(var a=0;a<this.breadcrumb.length;a++)if(this.breadcrumb[a].path===e.path){this.breadcrumb.splice(a+1,this.breadcrumb.length);break}this.loadData(),e.path||(this.createFolderShow=!0)},onClickItem:function(e){!0===e.dir?(this.breadcrumb.push(e),this.dataSource=[],this.queryParam.parentPath=e.path,this.loadData(),this.createFolderShow=!1):(this.image.name=e.name,this.image.resourcePath=e.resourcePath,this.image.canonicalFilePath=e.canonicalFilePath,this.image.showModal=!0)},handleImageModalCancel:function(e){this.image.showModal=!1},deleteFile:function(e){var a=this,t={path:e.path};m(t).then((function(e){a.loadData()}))},onClickAnalysis:function(e){this.analysisModal.param.path=e.path,this.analysisModal.showModal=!0,this.analysisForm=this.$form.createForm(this,{name:"coordinated"})},getImagePath:function(e){return"/api"+e.path},onClickAnalysisModalCancel:function(){this.analysisModal.showModal=!1},onClickAnalysisModalOk:function(){var e=this;this.analysisForm.validateFields((function(a,t){if(a)return!1;var r=t.taskName,l=e.analysisModal.param.path;delete t.taskName,delete t.path;var o={path:l,taskName:r,param:JSON.stringify(t)};d(o).then((function(a){0===a.code?(e.onClickAnalysisModalCancel(),e.messageConfirm("The task is in progress. Please check the analysis results later",a.data)):e.warning(a.msg)}))}))},messageConfirm:function(e,a){var t=this.$createElement,r=this;a?o["a"].confirm({title:"Success",content:e,okText:"View Analysis Results",closable:!0,closeIcon:t("close-outlined"),maskClosable:!0,cancelText:"Got it",icon:function(){return""},onOk:function(){r.$router.push({path:"/task/"+a})}}):o["a"].confirm({title:"Create failed ！",closable:!0,okText:"Got it",maskClosable:!0,icon:function(){return""}})},loadData:function(e){var a=this,t=Object.assign({},this.queryParam);c(t).then((function(t){a.dataSource=t.data,e&&e()}))}}},b=p,g=t("2877"),k=Object(g["a"])(b,r,l,!1,null,null,null);a["default"]=k.exports}}]);