(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21697b"],{c2b8:function(a,e,t){"use strict";t.r(e);var r=function(){var a=this,e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",{attrs:{bordered:!1}},[r("div",[r("a-row",{attrs:{gutter:0}},[r("a-col",{attrs:{md:10,sm:24}},[r("a-form",{attrs:{layout:"inline"}},[r("a-form-item",[r("a-button",{attrs:{icon:"folder-add",type:"primary"},on:{click:function(a){return e.showUploadModal()}}},[e._v("上传图片")]),r("a-button",{attrs:{icon:"folder-add"},on:{click:function(a){return e.clickAddFolder()}}},[e._v("新建文件夹")])],1)],1)],1),r("a-col",{attrs:{md:14,sm:24}},[r("a-form",{attrs:{layout:"inline"}},[r("a-form-item",{attrs:{label:"文件名称"}},[r("a-input",{attrs:{placeholder:"文件名称"},model:{value:e.queryParam.name,callback:function(a){e.$set(e.queryParam,"name",a)},expression:"queryParam.name"}})],1),r("a-form-item",[r("a-button",{on:{click:function(a){return e.loadData()}}},[e._v("查询")]),r("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){return a.queryParam={}}}},[e._v("重置")])],1)],1)],1)],1)],1),r("a-breadcrumb",{attrs:{separator:"/"}},e._l(e.breadcrumb,(function(a,t){return r("a-breadcrumb-item",{key:a.id},[t!==e.breadcrumb.length-1?r("a",{on:{click:function(t){return e.onClickBreadcrumb(a)}}},[e._v(e._s(a.name))]):r("span",[e._v(e._s(a.name))])])})),1),r("a-table",{attrs:{"data-source":e.dataSource,rowKey:"path"}},[r("a-table-column",{key:"name",attrs:{title:"文件名","data-index":"name"},scopedSlots:e._u([{key:"default",fn:function(a,t){return[r("a",{on:{click:function(a){return e.onClickItem(t)}}},[!0===t.dir?r("a-icon",{staticStyle:{color:"goldenrod",fontSize:"20px","margin-right":"10px"},attrs:{type:"folder",theme:"filled"}}):r("a-icon",{staticStyle:{fontSize:"20px","margin-right":"10px"},attrs:{type:"file-text",theme:"filled"}}),r("span",{staticStyle:{color:"black"}},[e._v(e._s(t.name))])],1)]}}])}),r("a-table-column",{key:"lastModified",attrs:{title:"修改时间","data-index":"lastModified"},scopedSlots:e._u([{key:"default",fn:function(a,t){return[e._v(" "+e._s(e.formatDate(t.lastModified))+" ")]}}])}),r("a-table-column",{key:"action",attrs:{title:"操作"},scopedSlots:e._u([{key:"default",fn:function(a,t){return[r("span",[r("a-button",{on:{click:function(a){return e.deleteFile(t)}}},[e._v("删除")]),r("a-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:function(a){return e.onClickAnalysis(t)}}},[e._v("创建分析任务")])],1)]}}])})],1),r("a-drawer",{attrs:{title:e.image.name,placement:"left",closable:!0,maskClosable:!1,visible:e.image.showModal,width:"90%"},on:{close:e.handleImageModalCancel}},[r("a",{staticStyle:{"font-size":"20px",border:"silver 1px"},attrs:{href:e.image.resourcePath,download:e.image.name}},[e._v("下载")]),r("span",{staticStyle:{"margin-left":"20px"}},[e._v("文件路径 "+e._s(e.image.canonicalFilePath))]),r("img",{attrs:{src:e.image.resourcePath,width:"100%"}})]),r("a-modal",{attrs:{title:"新建文件夹",visible:e.folder.showModal},on:{cancel:e.handleFolderModalCancel,ok:e.handleFolderModalOk}},[r("a-input",{attrs:{placeholder:"文件夹名称"},model:{value:e.folder.name,callback:function(a){e.$set(e.folder,"name",a)},expression:"folder.name"}})],1),r("a-modal",{attrs:{title:"上传图片",visible:e.upload.showModal},on:{cancel:e.handleUploadModalCancel,ok:e.handleUploadModalOk}},[r("a-upload",{attrs:{name:"files",accept:"image/*",multiple:!0,withCredentials:!0,listType:"picture",action:"/api/sourceImage/uploadFile",headers:e.headers,data:e.getUploadData(),showUploadList:e.upload.showUploadList},on:{change:e.handleChange},model:{value:e.upload.fileList,callback:function(a){e.$set(e.upload,"fileList",a)},expression:"upload.fileList"}},[r("a-button",{attrs:{type:"primary"}},[r("a-icon",{attrs:{type:"upload"}}),e._v(" 选择图片 ")],1)],1)],1),r("a-modal",{attrs:{title:"创建分析任务",visible:e.analysisModal.showModal,okText:"确定"},on:{cancel:e.onClickAnalysisModalCancel,ok:e.onClickAnalysisModalOk}},[r("a-form",{attrs:{form:e.analysisForm,"label-col":{span:5},"wrapper-col":{span:12}}},[r("a-form-item",{attrs:{label:"任务名称"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["taskName",{rules:[{required:!0,message:"Please input!"}]}],expression:"['taskName', { rules: [{ required: true, message: 'Please input!' }] }]"}],attrs:{placeholder:"标注此次任务",maxLength:50}})],1),r("a-form-item",{attrs:{label:"d-thr"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["d-thr",{initialValue:"0.01"},{rules:[{required:!0,message:"Please select!"}]}],expression:"['d-thr', {initialValue: '0.01'}, { rules: [{ required: true, message: 'Please select!' }] }]"}],staticStyle:{width:"100%"},attrs:{min:0,placeholder:"初次降噪"}}),e._v(" 常用范围为0-0.05 ")],1),r("a-form-item",{attrs:{label:"fill"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["fill",{initialValue:"10"},{rules:[{required:!0,message:"Please select!"}]}],expression:"['fill', {initialValue: '10'}, { rules: [{ required: true, message: 'Please select!' }] }]"}],staticStyle:{width:"100%"},attrs:{min:0,placeholder:"加深初次识别区域"}}),e._v(" 常用范围为0-15 ")],1),r("a-form-item",{attrs:{label:"flood"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["flood",{initialValue:"Y"},{rules:[{required:!0,message:"Please select!"}]}],expression:"[\n            'flood', {initialValue: 'Y'},\n            { rules: [{ required: true, message: 'Please select!' }] },\n          ]"}],attrs:{placeholder:"将相连区域填实"}},[r("a-select-option",{attrs:{value:"Y"}},[e._v(" Yes ")]),r("a-select-option",{attrs:{value:"N"}},[e._v(" No ")])],1),r("span",[e._v("选择相连区域是否需要填实")])],1),r("a-form-item",{attrs:{label:"obj-thr"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["obj-thr",{initialValue:"5"},{rules:[{required:!0,message:"Please select!"}]}],expression:"['obj-thr', {initialValue: '5'}, { rules: [{ required: true, message: 'Please select!' }] }]"}],staticStyle:{width:"100%"},attrs:{min:0,max:100,placeholder:"最终降噪",formatter:function(a){return a+"%"},parser:function(a){return a.replace("%","")}}}),e._v(" 去掉面积占全部图片的百分比，常用范围为0-10 ")],1),r("a-form-item",{attrs:{label:"stained-thr"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["stained-thr",{initialValue:"100"},{rules:[{required:!0,message:"Please select!"}]}],expression:"['stained-thr', {initialValue: '100'}, { rules: [{ required: true, message: 'Please select!' }] }]"}],staticStyle:{width:"100%"},attrs:{min:0,max:255,placeholder:"染色区域阈值"}}),e._v(" von kossa常用值为140，alizarin red常用值为100 ")],1)],1)],1)],1)},l=[],o=(t("a434"),t("b0c0"),t("cd17"),t("ed3b")),i=(t("3b18"),t("f64c")),n=t("b775"),s={sourceList:"/sourceImage/list",addFolder:"/sourceImage/addFolder",removeFile:"/sourceImage/remove",createTask:"/sourceImage/createTask"};function d(a){return Object(n["b"])({url:s.createTask,method:"post",data:a})}function c(a){return Object(n["b"])({url:s.sourceList,method:"get",params:a})}function u(a){return Object(n["b"])({url:s.addFolder,method:"post",params:a})}function m(a){return Object(n["b"])({url:s.removeFile,method:"delete",params:a})}var h=t("c1df"),f=t.n(h),p={name:"TableList",data:function(){return{analysisForm:{},headers:{authorization:"authorization-text"},image:{name:"",showModal:!1,scr:""},folder:{name:"",showModal:!1},upload:{showModal:!1,showUploadList:{showRemoveIcon:!1},fileList:[]},breadcrumb:[{name:"全部文件",path:""}],visible:!1,confirmLoading:!1,queryParam:{parentPath:"",name:""},dataSource:[],analysisModal:{showModal:!1,param:{path:""}}}},filters:{},created:function(){this.loadData()},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{formatDate:function(a){return f()(a).format("YYYY-MM-DD HH:mm:ss")},showUploadModal:function(){this.upload.fileList=[],this.upload.showModal=!0},handleUploadModalOk:function(){this.loadData(),this.upload.showModal=!1},handleUploadModalCancel:function(){this.loadData(),this.upload.showModal=!1},getUploadData:function(){return{parentPath:this.queryParam.parentPath}},handleChange:function(a){a.file.status,"done"===a.file.status?i["a"].success("".concat(a.file.name," file uploaded successfully")):"error"===a.file.status&&i["a"].error("".concat(a.file.name," file upload failed."))},handleFolderModalCancel:function(){this.folder.showModal=!1},handleFolderModalOk:function(){var a=this,e={name:this.folder.name,parentPath:this.queryParam.parentPath};u(e).then((function(e){a.loadData(),a.folder.showModal=!1}))},clickAddFolder:function(){this.folder.name="",this.folder.showModal=!0},onClickBreadcrumb:function(a){this.queryParam.parentPath=a.path;for(var e=0;e<this.breadcrumb.length;e++)if(this.breadcrumb[e].path===a.path){this.breadcrumb.splice(e+1,this.breadcrumb.length);break}this.loadData()},onClickItem:function(a){!0===a.dir?(this.breadcrumb.push(a),this.dataSource=[],this.queryParam.parentPath=a.path,this.loadData()):(this.image.name=a.name,this.image.resourcePath=a.resourcePath,this.image.canonicalFilePath=a.canonicalFilePath,this.image.showModal=!0)},handleImageModalCancel:function(a){this.image.showModal=!1},deleteFile:function(a){var e=this,t={path:a.path};m(t).then((function(a){e.loadData()}))},onClickAnalysis:function(a){this.analysisModal.param.path=a.path,this.analysisModal.showModal=!0,this.analysisForm=this.$form.createForm(this,{name:"coordinated"})},getImagePath:function(a){return"/api"+a.path},onClickAnalysisModalCancel:function(){this.analysisModal.showModal=!1},onClickAnalysisModalOk:function(){var a=this;this.analysisForm.validateFields((function(e,t){if(e)return!1;var r=t.taskName,l=a.analysisModal.param.path;delete t.taskName,delete t.path;var o={path:l,taskName:r,param:JSON.stringify(t)};d(o).then((function(e){0===e.code?(a.onClickAnalysisModalCancel(),a.messageConfirm("任务执行中，请稍后查看分析结果",e.data)):a.warning(e.msg)}))}))},messageConfirm:function(a,e){var t=this;o["a"].confirm({title:"Confirm",content:a,okText:"查看分析结果",cancelText:"知道了",onOk:function(){t.$router.push({path:"/task/"+e})}})},loadData:function(a){var e=this,t=Object.assign({},this.queryParam);c(t).then((function(t){e.dataSource=t.data,a&&a()}))}}},b=p,v=t("2877"),g=Object(v["a"])(b,r,l,!1,null,null,null);e["default"]=g.exports}}]);